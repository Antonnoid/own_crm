import{u as U}from"./user.module-e87b7e4c.js";import{r as h,c as M,o as B,a as _,b as n,h as f,w as i,f as v,i as k,d as y,F as T,g as O,k as C,t as P,u as L,l as j,e as r,n as S}from"./index-dc8ff5dc.js";import{r as A}from"./TrashIcon-3bffa9f5.js";import"./auth-header-ad4d04ca.js";const G={key:0},z={__name:"Modals",props:{routeName:String,open:Boolean},emits:["toggle"],setup(x,{emit:R}){const t=x,a=U(),g=h(!1),m=M(()=>c.value&&c.value[0]?"Добавить новый "+c.value[0].title:"Добавить новый"),d=h({place:t.routeName,fields:{}}),b=()=>{R("toggle")},c=h([]),E=h([]),D=async()=>{try{await a.getPlacesSubChild(t.routeName),c.value=a.placesSubChild,console.log("res",c.value)}catch(l){console.error("Error fetching data in component:",l)}},F=async l=>{await a.getOptionsData(l),E.value=a.optionData,console.log("focus",state.data)},I=async l=>{g.value=!0,await a.addNewPlaceChild(d.value),await a.getPlacesChild(t.routeName),g.value=!1,R("toggle"),Object.keys(d.value).forEach(p=>{d.value[p]=""})};B(()=>{D(),s()});const s=async()=>{try{await a.getPlacesChild("regions"),await a.getPlacesChild("districts"),await a.getPlacesChild("vicinity"),await a.getPlacesChild("metro_line")}catch(l){console.error("Error fetching data in component:",l)}};return(l,p)=>{const Y=_("a-input"),u=_("a-form-item"),N=_("a-select-option"),q=_("a-select"),V=_("a-form"),w=_("a-button"),$=_("a-modal");return n(),f($,{open:t.open,"onUpdate:open":p[0]||(p[0]=e=>t.open=e),title:m.value,onOk:I,closable:"",onCancel:b},{footer:i(()=>[v(w,{key:"back",onClick:b},{default:i(()=>[k("Отменить")]),_:1}),v(w,{key:"submit",type:"primary",loading:g.value,onClick:I},{default:i(()=>[k("Сохранить")]),_:1},8,["loading"])]),default:i(()=>[v(V,{name:"basic",autocomplete:"off",onFinish:l.onFinish,onFinishFailed:l.onFinishFailed},{default:i(()=>[c.value&&c.value[0]?(n(),y("div",G,[(n(!0),y(T,null,O(c.value[0].fields,e=>(n(),y("div",{key:e.id},[e.type==="text"?(n(),f(u,{key:0,label:e.name,name:e.name,rules:[{required:e.required}]},{default:i(()=>[v(Y,{value:d.value.fields[e.code],"onUpdate:value":o=>d.value.fields[e.code]=o,ref_for:!0,ref:e.code,type:e.html,onChange:l.onChangeInput,class:"!w-[200px]"},null,8,["value","onUpdate:value","type","onChange"])]),_:2},1032,["label","name","rules"])):C("",!0),e.type=="select"&&e.mode=="static"?(n(),f(u,{key:1,label:e.name,name:e.name,rules:[{required:e.required,message:"Required"}]},{default:i(()=>[v(q,{value:d.value.fields[e.code],"onUpdate:value":o=>d.value.fields[e.code]=o,"show-search":"","filter-option":l.filterOption,class:"!w-[200px]"},{default:i(()=>[(n(!0),y(T,null,O(e.options,o=>(n(),f(N,{key:o.id,value:o.id},{default:i(()=>[k(P(o.value),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","filter-option"])]),_:2},1032,["label","name","rules"])):C("",!0),e.type=="select"&&e.mode=="ajax"?(n(),f(u,{key:2,label:e.name,name:e.name,rules:[{required:e.required,message:"Required"}]},{default:i(()=>[v(q,{value:e.code,"onUpdate:value":o=>e.code=o,"show-search":"","filter-option":l.filterOption,onFocus:o=>F(e.code),class:"!w-[200px]"},{default:i(()=>[(n(!0),y(T,null,O(E.value,o=>(n(),f(N,{key:o.id,value:o.value},{default:i(()=>[k(P(o.value),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","filter-option","onFocus"])]),_:2},1032,["label","name","rules"])):C("",!0)]))),128))])):C("",!0)]),_:1},8,["onFinish","onFinishFailed"])]),_:1},8,["open","title"])}}},H={id:"app"},J={class:"filter"},K={class:"filter__task --w-refresh hidden-desktop"},Q=r("div",{class:"filter__task-t"},[r("p",{class:"filter__text"},"Фильтр")],-1),W={class:"filter__refresh"},X={class:"single__main"},Z={class:"single__main-slider --info show-flex"},ee={class:"single__form"},ae={style:{display:"flex",gap:"10px","align-items":"center"}},oe={__name:"_id",setup(x){const R=h([]),t=U(),a=L(),g=h(!1),m=h(!1),d=h(),b=j({type:"new",data:{NAME:"",PROPERTY_REGION_TYPE:"",PROPERTY_REGION_ID:"",PROPERTY_FOR_TITLE:"",PROPERTY_LOCALITY_TYPE:"",PROPERTY_DISTRICT_ID:"",PROPERTY_VICINITY_ID:""},place:a.params.id}),c=()=>{g.value=!g.value},E=M(()=>a.params.id==="regions"?t.regions:a.params.id==="vicinity"?t.vicinities:a.params.id==="highway"?t.highways:a.params.id==="localities"?t.localities:a.params.id==="highways"?t.highways:a.params.id==="place"?t.place:a.params.id==="districts"?t.districts:a.params.id==="metro"?t.metro:a.params.id==="metro_line"?t.metro_line:[]),D=async s=>{console.log("test",s)},F=async(s,l)=>{l.preventDefault(),d.value=s.id,m.value=!0;const p={type:"delete",id:s.id,place:a.params.id,data:{NAME:s.value,PROPERTY_REGION_TYPE:""}};await t.addNewPlaceChild(p),await t.getPlacesChild(a.params.id),R.value=t.placesChild,m.value=!1};B(()=>{I()});const I=async()=>{m.value=!0;try{await t.getPlacesChild(a.params.id).then(s=>{s.data.result==="error"&&message.error(s.data.text),m.value=!1})}catch(s){console.error("Error fetching data in component:",s)}};return(s,l)=>{const p=_("a-spin"),Y=_("router-link");return n(),y("div",null,[r("main",H,[r("div",J,[r("div",K,[Q,r("div",W,[r("div",{onClick:l[0]||(l[0]=u=>s.clearFilter()),class:"filter__refresh-btn"}," Сбросить "),r("div",{onClick:c,class:"filter__refresh-btn"}," Добавить "+P(S(a).params.id),1),v(z,{routeName:S(a).params.id,open:g.value,newItem:b,onToggle:c,onSave:D},null,8,["routeName","open","newItem"])])])]),r("div",X,[r("div",Z,[r("div",ee,[(n(!0),y(T,null,O(E.value,u=>(n(),f(Y,{to:"/places/"+s.$route.params.id+"/"+u.id,style:{"margin-left":"10px"},class:"single__item places__item flex justify-between",key:u.id},{default:i(()=>[r("div",ae,[m.value&&u.id===d.value?(n(),f(p,{key:0})):C("",!0),k(" "+P(u.value)+" - "+P(u.id),1)]),v(S(A),{onClick:N=>F(u,N),class:"w-10 h-10"},null,8,["onClick"])]),_:2},1032,["to"]))),128))])])])])])}}};export{oe as default};
